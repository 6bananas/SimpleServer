### IP端口

for 前端：127.0.0.1:5001

for 硬件：127.0.0.1:5000

### 工具

前端 - 服务器：Postman

硬件 - 服务器：NetAssist.exe

### 前端API

#### 修改饮水机状态

 接口：`/change_state`

方法：POST

格式：

```json
{"id":2001, "state":2}
```

返回：

- 成功：200状态码
- 失败：500状态码

#### 修改TH值

接口：`/change_th`

方法：POST

格式：

```json
{"id":2001,"th":2}
```

返回：`{"msg": "change th success"}` 和 200状态码

#### 查询饮水机位置、状态、水质

接口：`/query_info`

方法：GET

格式：`/query_info`

返回：

- 成功：200状态码

  ```json
  [
      {
          "id": 2001,
          "location": "图书馆",
          "state": 2,
          "tds": 99.8
      },
      {
          "id": 2002,
          "location": "教学楼",
          "state": 1,
          "tds": 97.1
      }
  ]
  ```

- 失败：500状态码

#### 查询某饮水机某段时间内的饮水总量

接口：`/query_sum`

方法：POST

格式：

```json
{"id":2001, "begintime":"2024-07-07 09:00:00", "endtime":"2024-07-07 10:00:00"}
```

返回：

- 成功：200状态码

  ```json
  {
      "sum": "700"
  }
  ```
  
- 失败：500状态码

#### 查询某学生某段时间在所有饮水机的饮水总量

接口：`/query_stu_sum`

方法：POST

格式：

```json
{"cardnumber":2101, "begintime":"2024-07-07 09:00:00", "endtime":"2024-07-07 10:00:00"}
```

返回：

- 成功：200状态码

  ```json
  {
      "sum": "700"
  }
  ```
  
- 失败：500状态码

### 硬件数据

每次复位：改为正常，然后返回。

状态代码：0:复位、1:正常、2:暂停、3:故障、4:报警。

error/warning/normal 状态格式：

```
{"ID":2001,"localTime":"2023-09-04 20:07:32","state":"Error1"}
{"ID":2001,"localTime":"2023-09-04 20:07:32","state":"Warning1"}
{"ID":2001,"localTime":"2023-09-04 20:07:32","state":"Normal"}
```

复位格式：`{"ID":2001,"state":"reset"}`

饮水数据格式：
```
//单次
{"ID":2001,"localTime":"2023-09-04 20:07:32","cardNum":"0004986831","water":200}
//一组
[{"ID":2001,"localTime":"2023-09-04 20:07:32","cardNum":"0004986831","water":200},{"ID":2001,"localTime":"2023-09-04 20:07:32","cardNum":"0004986831","water":300},]
```
